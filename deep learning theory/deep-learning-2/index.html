<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.23.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>시계열 처리 신경망 (2) - LSTM - Hail Song’s Blog</title>
<meta name="description" content="LSTM의 구조와 원리">


  <meta name="author" content="Hail Song">
  
  <meta property="article:author" content="Hail Song">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="Hail Song's Blog">
<meta property="og:title" content="시계열 처리 신경망 (2) - LSTM">
<meta property="og:url" content="https://hailsong.github.io/deep%20learning%20theory/deep-learning-2/">


  <meta property="og:description" content="LSTM의 구조와 원리">







  <meta property="article:published_time" content="2021-06-16T00:00:00+00:00">



  <meta property="article:modified_time" content="2021-06-16T13:06:00+00:00">



  

  


<link rel="canonical" href="https://hailsong.github.io/deep%20learning%20theory/deep-learning-2/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Hail Song",
      "url": "https://hailsong.github.io/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Hail Song's Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Hail Song's Blog
          <span class="site-subtitle">hail96@kaist.ac.kr</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/Curriculum%20Vitae/">Curriculum Vitae</a>
            </li><li class="masthead__menu-item">
              <a href="/publications/">Publications</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/posts/">Posts</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://hailsong.github.io/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#deep-learning-theory" itemprop="item"><span itemprop="name">Deep learning theory</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">시계열 처리 신경망 (2) - LSTM</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/avatar.png" alt="Hail Song" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Hail Song</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Ph.D. Candidate at KAIST UVRlab, XR / Computer Vision / Computer Graphics Researcher</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Daejeon, Republic of Korea</span>
        </li>
      

      
        
          
        
          
            <li><a href="https://uvrlab.org/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">UVRlab</span></a></li>
          
        
          
        
          
        
          
            <li><a href="https://www.linkedin.com/in/hailsong" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://github.com/hailsong" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://instagram.com/song.ha12" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
          
            <li><a href="https://www.youtube.com/watch?v=hmRNMZlz974" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-youtube" aria-hidden="true"></i><span class="label">Youtube</span></a></li>
          
        
      

      

      
        <li>
          <a href="mailto:hail96@kaist.ac.kr">
            <meta itemprop="email" content="hail96@kaist.ac.kr" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">이메일</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="시계열 처리 신경망 (2) - LSTM">
    <meta itemprop="description" content="LSTM의 구조와 원리">
    <meta itemprop="datePublished" content="2021-06-16T00:00:00+00:00">
    <meta itemprop="dateModified" content="2021-06-16T13:06:00+00:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">시계열 처리 신경망 (2) - LSTM
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 분 소요
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h3 id="-개요">✅ 개요</h3>

<p>회사 업무서 시계열 데이터를 다룰 일들이 있어 시계열 처리를 위한 신경망들을 사용했었습니다. 회사 내부적으로 AI세미나라는 이름으로 스터디를 진행하고 있는데 시계열 처리 신경망들을 발표할 일이 생겨 정리할 겸 포스트를 남겨보려 합니다.</p>

<p>이 포스트는 시계열 분석 신경망 RNN, LSTM, GRU 에 대해 스터디한 내용을 정리하는 두 번째 포스트로 LSTM에 대해 다룹니다.</p>

<p>Ref : <a href="https://ratsgo.github.io/natural%20language%20processing/2017/03/09/rnnlstm/">https://ratsgo.github.io/natural%20language%20processing/2017/03/09/rnnlstm/</a></p>

<p>ratsgo님의 블로그인데 공부하는 데에 굉장히 도움을 많이 받았습니다!</p>

<p>이미지 출처 : <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">https://colah.github.io/posts/2015-08-Understanding-LSTMs/</a></p>

<hr />

<h3 id="-rnn의-한계">❗ RNN의 한계</h3>

<p>앞선 포스팅에서 RNN에 대해 알아보았는데 이런 RNN에는 치명적인 한계가 있습니다. 무엇일까요?</p>

<center><img src="\assets\img\dl2_01.png" width="80%" height="80%" /></center>

<p>정답은 장기 의존성 문제입니다. RNN의 경우 정보와 그 정보를 사용하는 지점 사이가 가까운 경우 문제가 없지만 정보와 사용 지점의 거리 차이가 크면 학습 능력이 저하되는 장기 의존성 문제가 발생하게 됩니다. LSTM은 오래된 정보가 사라지는 것을 방지하기 위해 만들어진 신경망입니다.</p>

<hr />

<h3 id="-lstm이란">❓ LSTM이란?</h3>

<center><img src="\assets\img\dl2_02.png" width="80%" height="80%" /></center>

<p>RNN보다 조금 더 복잡해진 LSTM의 구조입니다. 위쪽 신경망이 이전 포스트에서 설명드린 RNN, 아래쪽의 신경망이 LSTM입니다. LSTM은 Long Short Term Memory의 약자입니다. Input Gate의 노드들 사이에는 RNN에서 사용한 tanh 말고도 sigmoid함수도 사용됩니다.</p>

<p>LSTM은 어떻게 장기 의존성 문제를 회피할까요?</p>

<center><img src="\assets\img\dl2_03.png" width="80%" height="80%" /></center>

<p>LSTM은 Cell state라는 구조를 통해 장기 의존성 문제를 피합니다. Cell State는 어떤 정보를 기억할지, 어떤 정보를 버릴지에 대한 데이터를 기억합니다.</p>

<p>이전 은닉층의 데이터와 이번 시퀀스의 input 데이터는 합쳐져 네 갈래로 복제됩니다. 이 중 첫번째 갈래는 sigmoid 함수를 지나 Cell state로 들어가 이전 Cell state 정보를 기억할지 안할지를 결정합니다. 이 부분이 Cell state와 합쳐지는 상황에서 X표시가 되어있는데 0~1사이의 output과 Cell State의 기존 데이터가 요소별로 곱해져 이전 cell state를 기억할지 버릴지를 정하게 됩니다. 이 X표시 Gate를 Forget Gate라고 부릅니다.</p>

<center><img src="\assets\img\dl2_04.png" width="80%" height="80%" /></center>

<p>복제된 네 갈래 중 두번째 세번째 갈래는 각각 시그모이드와 hyperbolic tangent함수를 거쳐 요소곱을 하게 되고 이 데이터는 Cell state에 concatenate됩니다. Concatenate는 더해지는것과 달리 기존 데이터 매트릭스 옆으로 정보를 붙이는 것을 의미합니다. 시퀀스를 지날때마다 Cell state에 concatenate되니까 이 Cell State는 점점 크기가 커지게 되는 것이지요.</p>

<center><img src="\assets\img\dl2_05.png" width="80%" height="80%" /></center>

<p>복제된 마지막 데이터는 sigmoid함수를 거쳐 Cell State정보와 요소곱을 해 output이 되고 다음 은닉층으로 향하게 됩니다.</p>

<hr />

<h3 id="-forward-propagation-순전파">🔜 Forward Propagation (순전파)</h3>

<center><img src="\assets\img\dl2_06.png" width="80%" height="80%" /></center>

<p>Forward Propagation은 다음과 같이 이뤄집니다. 중간에 H_t가 네 갈래로 나뉘는 것을 다른 문자로 나누었음을 확인합니다. 활성함수가 차이가 있음에 유의합니다.</p>

<hr />

<h3 id="-backpropagation-역전파">🔙 Backpropagation (역전파)</h3>

<center><img src="\assets\img\dl2_07.png" width="80%" height="80%" /></center>

<p>역전파는 다음과 같이 이루어져 가중치의 업데이트에 사용됩니다. dH_t는 4갈래로 나뉜 엣지들의 로컬 그라디언트들의 합으로 계산됨에 유의합니다.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#deep-learning" class="page__taxonomy-item" rel="tag">deep learning</a><span class="sep">, </span>
    
      <a href="/tags/#deep-learning-theory" class="page__taxonomy-item" rel="tag">deep learning theory</a><span class="sep">, </span>
    
      <a href="/tags/#lstm" class="page__taxonomy-item" rel="tag">LSTM</a><span class="sep">, </span>
    
      <a href="/tags/#time-series" class="page__taxonomy-item" rel="tag">time series</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#deep-learning-theory" class="page__taxonomy-item" rel="tag">Deep Learning Theory</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2021-06-16">June 16, 2021</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%EC%8B%9C%EA%B3%84%EC%97%B4+%EC%B2%98%EB%A6%AC+%EC%8B%A0%EA%B2%BD%EB%A7%9D+%282%29+-+LSTM%20https%3A%2F%2Fhailsong.github.io%2Fdeep%2520learning%2520theory%2Fdeep-learning-2%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fhailsong.github.io%2Fdeep%2520learning%2520theory%2Fdeep-learning-2%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fhailsong.github.io%2Fdeep%2520learning%2520theory%2Fdeep-learning-2%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/deep%20learning%20theory/deep-learning-1/" class="pagination--pager" title="시계열 처리 신경망 (1) - RNN
">이전</a>
    
    
      <a href="/deep%20learning%20theory/deep-learning-3/" class="pagination--pager" title="시계열 처리 신경망 (3) - GRU
">다음</a>
    
  </nav>

    </div>

    <div id="disqus_thread"></div>
    <script>
        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://hailsong-github-io.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    

  </article>

  

  
    <div class="page__related">
      <h4 class="page__related-title">참고</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/study/Gaussian-Splatting-1/" rel="permalink">Run 3D Gaussian Splatting (1) - Windows에서 3D 가우시안 스플래팅 구동
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Run 3D Gaussian Splatting on windows
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/avatar/Run-SMPLify-x-1/" rel="permalink">Run SMPLify-X (CVPR 2019)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Run SMPLify-X Demo code
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/avatar/Run-SCANimate-1/" rel="permalink">Run SCANimate (CVPR 2021)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Run SCANimate Demo code
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/coursework%20-%202022-1/Probability-and-Statistics-Summary/" rel="permalink">Probability and Statistics (1) - Summary (CH.2 ~ CH.7)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          최대 1 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Probability and Statistics summary for (Ch.2 ~ CH.7), KAIST CC511 관련 자료
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    <script data-ad-client="ca-pub-4455412024236606" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <div align="center" style="margin: 1em 0;">
    <ins class="adsbygoogle"
         style="display:block; border-bottom: initial;"
         data-ad-client="ca-pub-4455412024236606"
         data-ad-format="auto"></ins>
    </div> -->

    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://www.linkedin.com/in/hailsong" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 Hail Song. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>






<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LLKEW6ZWXP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LLKEW6ZWXP');
</script>






  </body>
</html>
